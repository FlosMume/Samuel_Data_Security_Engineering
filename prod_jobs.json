{
  "description": "PROD job compute on Docker from ACR; UC enforced; notebooks disabled; cost & tag guardrails.",
  "cluster_type": { "type": "fixed", "value": "job" },
  "spark_version": { "type": "fixed", "value": "auto:latest-lts" },
  "data_security_mode": { "type": "fixed", "value": "SINGLE_USER" },
  "single_user_name": { "type": "fixed", "value": "spn-cibc-dps-prod@aad" },

  "docker_image.url": {
    "type": "regex",
    "pattern": "^<acr>\\.azurecr\\.io/(golden|databricks)/[a-z0-9._/-]+:[vV]?\\d+\\.\\d+\\.\\d+(-r\\d+)?$"
  },
  "docker_image.basic_auth.username": { "type": "fixed", "value": "{{secrets/ACR/sp-username}}", "hidden": true },
  "docker_image.basic_auth.password": { "type": "fixed", "value": "{{secrets/ACR/sp-password}}", "hidden": true },

  "workload_type.clients.notebooks": { "type": "fixed", "value": false },
  "workload_type.clients.jobs": { "type": "fixed", "value": true },

  "autoscale.min_workers": { "type": "range", "minValue": 2, "maxValue": 16, "defaultValue": 2 },
  "autoscale.max_workers": { "type": "range", "minValue": 2, "maxValue": 64, "defaultValue": 8 },
  "dbus_per_hour": { "type": "range", "maxValue": 50 },

  "node_type_id": { "type": "allowlist", "values": ["Standard_E8ds_v5","Standard_E16ds_v5"] },
  "driver_node_type_id": { "type": "fixed", "value": "Standard_E8ds_v5" },
  "azure_attributes.availability": { "type": "fixed", "value": "ON_DEMAND_AZURE" },

  "enable_local_disk_encryption": { "type": "fixed", "value": true },

  "cluster_log_conf.type": { "type": "fixed", "value": "VOLUMES" },
  "cluster_log_conf.path": {
    "type": "regex",
    "pattern": "^/Volumes/<catalog>/<schema>/cluster-logs/[a-z0-9/_-]+$"
  },

  "init_scripts.0.abfss.destination": {
    "type": "fixed",
    "value": "abfss://init@<storage>.dfs.core.windows.net/bootstrap/prod-bootstrap.sh"
  },
  "init_scripts.*.workspace.destination": { "type": "forbidden" },
  "init_scripts.*.file.destination": { "type": "forbidden" },

  "custom_tags.ENV": { "type": "fixed", "value": "PROD" },
  "custom_tags.COST_CENTER": { "type": "allowlist", "values": ["DPS","FCRT","RISK"] }
}
